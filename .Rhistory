hist(fetal_df$abnormal_short_term_variability,
main="Histogram for abnormal_short_term_variability",
xlab="abnormal_short_term_variability",
border="black",
col="wheat")
fetal_df %>%
ggplot( aes(as.numeric(row.names(fetal_df)), abnormal_short_term_variability)) +
geom_boxplot(color="tomato3", fill="wheat", alpha=0.2) +
geom_jitter(color="black", size=0.4, alpha=0.35) +
theme_minimal() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("abnormal_short_term_variability boxplot") +
xlab("observation no.")
hist(fetal_df$percentage_of_time_with_abnormal_long_term_variability,
main="Histogram for percentage_of_time_with_abnormal_long_term_variability",
xlab="percentage_of_time_with_abnormal_long_term_variability",
border="black",
col="wheat")
fetal_df %>%
ggplot( aes(as.numeric(row.names(fetal_df)), percentage_of_time_with_abnormal_long_term_variability)) +
geom_boxplot(color="tomato3", fill="wheat", alpha=0.2) +
geom_jitter(color="black", size=0.4, alpha=0.35) +
theme_minimal() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("percentage_of_time_with_abnormal_long_term_variability boxplot") +
xlab("observation no.")
hist(fetal_df$mean_value_of_long_term_variability,
main="Histogram for mean_value_of_long_term_variability",
xlab="mean_value_of_long_term_variability",
border="black",
col="wheat")
fetal_df %>%
ggplot( aes(as.numeric(row.names(fetal_df)), mean_value_of_long_term_variability)) +
geom_boxplot(color="tomato3", fill="wheat", alpha=0.2) +
geom_jitter(color="black", size=0.4, alpha=0.35) +
theme_minimal() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("mean_value_of_long_term_variability boxplot") +
xlab("observation no.")
hist(fetal_df$histogram_mode,
main="Histogram for histogram_mode",
xlab="histogram_mode",
border="black",
col="wheat")
fetal_df %>%
ggplot( aes(as.numeric(row.names(fetal_df)), histogram_mode)) +
geom_boxplot(color="tomato3", fill="wheat", alpha=0.2) +
geom_jitter(color="black", size=0.4, alpha=0.35) +
theme_minimal() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("histogram_mode boxplot") +
xlab("observation no.")
hist(fetal_df$histogram_variance,
main="Histogram for histogram_variance",
xlab="histogram_variance",
border="black",
col="wheat")
fetal_df %>%
ggplot( aes(as.numeric(row.names(fetal_df)), histogram_variance)) +
geom_boxplot(color="tomato3", fill="wheat", alpha=0.2) +
geom_jitter(color="black", size=0.4, alpha=0.35) +
theme_minimal() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("histogram_variance boxplot") +
xlab("observation no.")
fetal_train$fetal_health <- ordered(as.factor(fetal_train$fetal_health))
logreg01 <- glm(formula = fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = fetal_train, family = binomial)
summary(logreg01)
table(fetal_train$fetal_health)
#We can see that p(3) is currently .056 so let's increase it to .15
to.resample1 <- which(fetal_train$fetal_health == "3")
our.resample1 <- sample(x = to.resample1, size = 182, replace = TRUE)
our.resample1 <- fetal_train[our.resample1, ]
train_fetal_rebal <- rbind(fetal_train, our.resample1)
table(train_fetal_rebal$fetal_health)
library(foreign)
library(MASS)
library(Hmisc)
library(reshape2)
library(caret)
#train_fetal_rebal$fetal_health <- ordered(as.factor(train_fetal_rebal$fetal_health))
#fetal_test$fetal_health <- ordered(as.factor(fetal_test$fetal_health))
#logreg01 <- polr(formula = fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal, Hess = TRUE)
summary(logreg01)
logreg01_test <- predict(object = logreg01, newdata = fetal_test)
confusionMatrix(logreg01_test, fetal_test$fetal_health)
library(foreign)
library(MASS)
library(Hmisc)
library(reshape2)
library(caret)
#train_fetal_rebal$fetal_health <- ordered(as.factor(train_fetal_rebal$fetal_health))
#fetal_test$fetal_health <- ordered(as.factor(fetal_test$fetal_health))
#logreg01 <- polr(formula = fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal, Hess = TRUE)
summary(logreg01)
logreg01_test <- predict(object = logreg01, newdata = fetal_test)
confusionMatrix(logreg01_test, fetal_test$fetal_health)
library(foreign)
library(MASS)
library(Hmisc)
library(reshape2)
library(caret)
#train_fetal_rebal$fetal_health <- ordered(as.factor(train_fetal_rebal$fetal_health))
#fetal_test$fetal_health <- ordered(as.factor(fetal_test$fetal_health))
#logreg01 <- polr(formula = fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal, Hess = TRUE)
#summary(logreg01)
#logreg01_test <- predict(object = logreg01, newdata = fetal_test)
#confusionMatrix(logreg01_test, fetal_test$fetal_health)
library(nnet)
logreg02 <- multinom(fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal)
l <- summary(logreg02)
l
fetal_test_copy <- fetal_test
fetal_test_copy$fetal_health <- factor( fetal_test_copy$fetal_health , ordered = FALSE )
nlevels(fetal_test_copy$fetal_health)
fetal_test_copy$fetal_health<-relevel(fetal_test_copy, ref = "1")
library(foreign)
library(MASS)
library(Hmisc)
library(reshape2)
library(caret)
#train_fetal_rebal$fetal_health <- ordered(as.factor(train_fetal_rebal$fetal_health))
#fetal_test$fetal_health <- ordered(as.factor(fetal_test$fetal_health))
#logreg01 <- polr(formula = fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal, Hess = TRUE)
#summary(logreg01)
#logreg01_test <- predict(object = logreg01, newdata = fetal_test)
#confusionMatrix(logreg01_test, fetal_test$fetal_health)
library(nnet)
logreg02 <- multinom(fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal)
l <- summary(logreg02)
l
fetal_test_copy <- fetal_test
fetal_test_copy$fetal_health <- as.factor( fetal_test_copy$fetal_health , ordered = FALSE )
library(foreign)
library(MASS)
library(Hmisc)
library(reshape2)
library(caret)
#train_fetal_rebal$fetal_health <- ordered(as.factor(train_fetal_rebal$fetal_health))
#fetal_test$fetal_health <- ordered(as.factor(fetal_test$fetal_health))
#logreg01 <- polr(formula = fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal, Hess = TRUE)
#summary(logreg01)
#logreg01_test <- predict(object = logreg01, newdata = fetal_test)
#confusionMatrix(logreg01_test, fetal_test$fetal_health)
library(nnet)
logreg02 <- multinom(fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal)
l <- summary(logreg02)
l
lpred <- predict(logreg02, fetal_test_copy, type = 'Class')
library(foreign)
library(MASS)
library(Hmisc)
library(reshape2)
library(caret)
#train_fetal_rebal$fetal_health <- ordered(as.factor(train_fetal_rebal$fetal_health))
#fetal_test$fetal_health <- ordered(as.factor(fetal_test$fetal_health))
#logreg01 <- polr(formula = fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal, Hess = TRUE)
#summary(logreg01)
#logreg01_test <- predict(object = logreg01, newdata = fetal_test)
#confusionMatrix(logreg01_test, fetal_test$fetal_health)
library(nnet)
logreg02 <- multinom(fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal)
l <- summary(logreg02)
l
lpred <- predict(logreg02, fetal_test_copy, type = 'class')
table(fetal_test_copy$fetal_health,fetal_test_copy$predicted)
library(foreign)
library(MASS)
library(Hmisc)
library(reshape2)
library(caret)
train_fetal_rebal$fetal_health <- ordered(as.factor(train_fetal_rebal$fetal_health))
fetal_test$fetal_health <- ordered(as.factor(fetal_test$fetal_health))
#logreg01 <- polr(formula = fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal, Hess = TRUE)
#summary(logreg01)
#logreg01_test <- predict(object = logreg01, newdata = fetal_test)
#confusionMatrix(logreg01_test, fetal_test$fetal_health)
library(nnet)
logreg02 <- multinom(fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal)
l <- summary(logreg02)
l
lpred <- predict(logreg02, fetal_test_copy, type = 'class')
table(fetal_test_copy$fetal_health,fetal_test_copy$predicted)
View(fetal_test_copy)
library(foreign)
library(MASS)
library(Hmisc)
library(reshape2)
library(caret)
train_fetal_rebal$fetal_health <- ordered(as.factor(train_fetal_rebal$fetal_health))
fetal_test$fetal_health <- ordered(as.factor(fetal_test$fetal_health))
#logreg01 <- polr(formula = fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal, Hess = TRUE)
#summary(logreg01)
#logreg01_test <- predict(object = logreg01, newdata = fetal_test)
#confusionMatrix(logreg01_test, fetal_test$fetal_health)
library(nnet)
logreg02 <- multinom(fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal)
l <- summary(logreg02)
l
lpred <- predict(logreg02, fetal_test_copy, type = 'class')
table(fetal_test_copy$fetal_health, lpred)
library(foreign)
library(MASS)
library(Hmisc)
library(reshape2)
library(caret)
train_fetal_rebal$fetal_health <- ordered(as.factor(train_fetal_rebal$fetal_health))
fetal_test$fetal_health <- ordered(as.factor(fetal_test$fetal_health))
logreg01 <- polr(formula = fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal, Hess = TRUE)
summary(logreg01)
logreg01_test <- predict(object = logreg01, newdata = fetal_test)
confusionMatrix(logreg01_test, fetal_test$fetal_health)
library(nnet)
logreg02 <- multinom(fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal)
l <- summary(logreg02)
l
lpred <- predict(logreg02, fetal_test_copy, type = 'class')
table(fetal_test_copy$fetal_health, lpred)
library(foreign)
library(MASS)
library(Hmisc)
library(reshape2)
library(caret)
train_fetal_rebal$fetal_health <- ordered(as.factor(train_fetal_rebal$fetal_health))
fetal_test$fetal_health <- ordered(as.factor(fetal_test$fetal_health))
logreg01 <- polr(formula = fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal, Hess = TRUE)
summary(logreg01)
logreg01_test <- predict(object = logreg01, newdata = fetal_test)
confusionMatrix(logreg01_test, fetal_test$fetal_health)
library(nnet)
logreg02 <- multinom(fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal)
l <- summary(logreg02)
l
lpred <- predict(logreg02, fetal_test_copy, type = 'class')
confusionMatrix(fetal_test_copy$fetal_health, lpred)
library(foreign)
library(MASS)
library(Hmisc)
library(reshape2)
library(caret)
train_fetal_rebal$fetal_health <- ordered(as.factor(train_fetal_rebal$fetal_health))
fetal_test$fetal_health <- ordered(as.factor(fetal_test$fetal_health))
logreg01 <- polr(formula = fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal, Hess = TRUE)
summary(logreg01)
logreg01_test <- predict(object = logreg01, newdata = fetal_test)
confusionMatrix(logreg01_test, fetal_test$fetal_health)
library(nnet)
logreg02 <- multinom(fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal)
l <- summary(logreg02)
l
lpred <- predict(logreg02, fetal_test_copy, type = 'class')
confusionMatrix(fetal_test_copy$fetal_health, lpred)
knitr::opts_chunk$set(echo = TRUE)
library(reshape2)
library(corrplot)
library(ggplot2)
library(dplyr)
library(caret)
library(tidyverse)
library(arules)
library(e1071)
options(scipen=999)
fetal_df <- read.csv(file = 'fetal_health.csv')
## Count of missing values for each column.
sapply(fetal_df, function(x) sum(is.na(x)))
options(repr.plot.width = 25, repr.plot.height = 25)
fetal_health_corr <- cor(x = fetal_df$fetal_health,y = fetal_df[1:21])
corrplot::corrplot(fetal_health_corr, tl.cex=0.5, method = "number")
options(repr.plot.width = 25, repr.plot.height = 25)
fetal_corr <- cor(fetal_df)
corrplot::corrplot(fetal_corr, tl.cex=0.4)
fetal_df <- fetal_df[, c('prolongued_decelerations', 'abnormal_short_term_variability', 'percentage_of_time_with_abnormal_long_term_variability', 'accelerations', 'histogram_mode', 'mean_value_of_long_term_variability', 'histogram_variance', 'uterine_contractions','fetal_health')]
outliers <- function(x) {
Q1 <- quantile(x, probs=.25)
Q3 <- quantile(x, probs=.75)
iqr = Q3-Q1
upper_limit = Q3 + (iqr*1.5)
lower_limit = Q1 - (iqr*1.5)
x > upper_limit | x < lower_limit
}
remove_outliers <- function(df, cols = names(df)) {
for (col in cols) {
df <- df[!outliers(df[[col]]),]
}
df
}
fetal_df2 <- remove_outliers(fetal_df, c('abnormal_short_term_variability', 'histogram_mode'))
hist(fetal_df$fetal_health,
main="Histogram for fetal_health",
xlab="fetal_health",
border="black",
col="wheat")
barplot(table(fetal_df$fetal_health), col = c("powderblue", "pink", "plum2"),xlab = "Fetal Health", ylab = "Count", names.arg = c("1 = Normal", "2 = Suspect", "3 = Pathological"), main = "Bar Plot of Fetal Health")
## Create train and test sets; to be used later for modelling
## set the seed to make your partition reproducible
set.seed(7)
sample_size = round(nrow(fetal_df2)*.80)
index <- sample(seq_len(nrow(fetal_df2)), size = sample_size)
fetal_train <- fetal_df2[index, ]
fetal_test <- fetal_df2[-index, ]
fetal_train_dim <- dim(fetal_train)
cat('Number of Rows in Student Training Dataset: ', fetal_train_dim[1])
cat('Number of Variables in Student Training Dataset: ', fetal_train_dim[2])
#looking at dimensions of testing file
fetal_test_dim <- dim(fetal_test)
cat('Number of Rows in Student Testing Dataset: ', fetal_test_dim[1])
cat('Number of Variables in Student Testing Dataset: ', fetal_test_dim[2])
#looking at fetal health data
t1 <- table(fetal_train$fetal_health)
rownames(t1) <- c("1 = Normal", "2 = Suspect", " 3 = Pathalogical")
t1
#bar graph to see training and testing dimensions
fetal_train_test_prop <- c(fetal_train_dim[1], fetal_test_dim[1])
barplot(fetal_train_test_prop, col = c("palegreen", "cadetblue2"), main = "Bar Graph of Training vs Test Data Set Proportions", xlab = "Training vs Test", ylab = "Count", names.arg = c("Training Data", "Testing Data"), cex.names = 1)
#resampling code??????????????????????????
#do we need to validate?
hist(fetal_df$accelerations,
main="Histogram for accelerations",
xlab="accelerations",
border="black",
col="wheat")
fetal_df %>%
ggplot( aes(as.numeric(row.names(fetal_df)), accelerations)) +
geom_boxplot(color="tomato3", fill="wheat", alpha=0.2) +
geom_jitter(color="black", size=0.4, alpha=0.35) +
theme_minimal() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("accelerations boxplot") +
xlab("observation no.")
temp_fetal_df <- fetal_df
temp_fetal_df$fetal_health <- factor(temp_fetal_df$fetal_health)
accelerations_boxplot <- ggplot(data = temp_fetal_df, aes(x = factor(fetal_health), y = accelerations))
accelerations_boxplot + geom_boxplot(aes(fill = fetal_health)) + ylab("Accelerations") + ggtitle("Accelerations Boxplot") + stat_summary(fun=mean, geom = "point", shape = 5, size = 4)
par(mfrow=c(1,8))
for(i in 1:8) {
boxplot(temp_fetal_df[,i], main=names(temp_fetal_df)[i])
}
featurePlot(x=temp_fetal_df[,1:8], y= temp_fetal_df[,9], plot="box")
hist(fetal_df$uterine_contractions,
main="Histogram for uterine_contractions",
xlab="uterine_contractions",
border="black",
col="wheat")
fetal_df %>%
ggplot( aes(as.numeric(row.names(fetal_df)), uterine_contractions)) +
geom_boxplot(color="tomato3", fill="wheat", alpha=0.2) +
geom_jitter(color="black", size=0.4, alpha=0.35) +
theme_minimal() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("uterine_contractions boxplot") +
xlab("observation no.")
hist(fetal_df$prolongued_decelerations,
main="Histogram for prolongued_decelerations",
xlab="prolongued_decelerations",
border="black",
col="wheat")
fetal_df %>%
ggplot( aes(as.numeric(row.names(fetal_df)), prolongued_decelerations)) +
geom_boxplot(color="tomato3", fill="wheat", alpha=0.2) +
geom_jitter(color="black", size=0.4, alpha=0.35) +
theme_minimal() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("prolongued_decelerations boxplot") +
xlab("observation no.")
hist(fetal_df$abnormal_short_term_variability,
main="Histogram for abnormal_short_term_variability",
xlab="abnormal_short_term_variability",
border="black",
col="wheat")
fetal_df %>%
ggplot( aes(as.numeric(row.names(fetal_df)), abnormal_short_term_variability)) +
geom_boxplot(color="tomato3", fill="wheat", alpha=0.2) +
geom_jitter(color="black", size=0.4, alpha=0.35) +
theme_minimal() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("abnormal_short_term_variability boxplot") +
xlab("observation no.")
hist(fetal_df$percentage_of_time_with_abnormal_long_term_variability,
main="Histogram for percentage_of_time_with_abnormal_long_term_variability",
xlab="percentage_of_time_with_abnormal_long_term_variability",
border="black",
col="wheat")
fetal_df %>%
ggplot( aes(as.numeric(row.names(fetal_df)), percentage_of_time_with_abnormal_long_term_variability)) +
geom_boxplot(color="tomato3", fill="wheat", alpha=0.2) +
geom_jitter(color="black", size=0.4, alpha=0.35) +
theme_minimal() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("percentage_of_time_with_abnormal_long_term_variability boxplot") +
xlab("observation no.")
hist(fetal_df$mean_value_of_long_term_variability,
main="Histogram for mean_value_of_long_term_variability",
xlab="mean_value_of_long_term_variability",
border="black",
col="wheat")
fetal_df %>%
ggplot( aes(as.numeric(row.names(fetal_df)), mean_value_of_long_term_variability)) +
geom_boxplot(color="tomato3", fill="wheat", alpha=0.2) +
geom_jitter(color="black", size=0.4, alpha=0.35) +
theme_minimal() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("mean_value_of_long_term_variability boxplot") +
xlab("observation no.")
hist(fetal_df$histogram_mode,
main="Histogram for histogram_mode",
xlab="histogram_mode",
border="black",
col="wheat")
fetal_df %>%
ggplot( aes(as.numeric(row.names(fetal_df)), histogram_mode)) +
geom_boxplot(color="tomato3", fill="wheat", alpha=0.2) +
geom_jitter(color="black", size=0.4, alpha=0.35) +
theme_minimal() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("histogram_mode boxplot") +
xlab("observation no.")
hist(fetal_df$histogram_variance,
main="Histogram for histogram_variance",
xlab="histogram_variance",
border="black",
col="wheat")
fetal_df %>%
ggplot( aes(as.numeric(row.names(fetal_df)), histogram_variance)) +
geom_boxplot(color="tomato3", fill="wheat", alpha=0.2) +
geom_jitter(color="black", size=0.4, alpha=0.35) +
theme_minimal() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("histogram_variance boxplot") +
xlab("observation no.")
fetal_train$fetal_health <- ordered(as.factor(fetal_train$fetal_health))
logreg01 <- glm(formula = fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = fetal_train, family = binomial)
summary(logreg01)
table(fetal_train$fetal_health)
#We can see that p(3) is currently .056 so let's increase it to .15
to.resample1 <- which(fetal_train$fetal_health == "3")
our.resample1 <- sample(x = to.resample1, size = 182, replace = TRUE)
our.resample1 <- fetal_train[our.resample1, ]
train_fetal_rebal <- rbind(fetal_train, our.resample1)
table(train_fetal_rebal$fetal_health)
library(foreign)
library(MASS)
library(Hmisc)
library(reshape2)
library(caret)
train_fetal_rebal$fetal_health <- ordered(as.factor(train_fetal_rebal$fetal_health))
fetal_test$fetal_health <- ordered(as.factor(fetal_test$fetal_health))
logreg01 <- polr(formula = fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal, Hess = TRUE)
summary(logreg01)
logreg01_test <- predict(object = logreg01, newdata = fetal_test)
confusionMatrix(logreg01_test, fetal_test$fetal_health)
library(nnet)
logreg02 <- multinom(fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal)
l <- summary(logreg02)
l
lpred <- predict(logreg02, fetal_test_copy, type = 'class')
confusionMatrix(fetal_test_copy$fetal_health, lpred)
library(foreign)
library(MASS)
library(Hmisc)
library(reshape2)
library(caret)
train_fetal_rebal$fetal_health <- ordered(as.factor(train_fetal_rebal$fetal_health))
fetal_test$fetal_health <- ordered(as.factor(fetal_test$fetal_health))
logreg01 <- polr(formula = fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal, Hess = TRUE)
summary(logreg01)
logreg01_test <- predict(object = logreg01, newdata = fetal_test)
confusionMatrix(logreg01_test, fetal_test$fetal_health)
library(nnet)
logreg02 <- multinom(fetal_health ~ prolongued_decelerations + abnormal_short_term_variability + percentage_of_time_with_abnormal_long_term_variability + accelerations + histogram_mode + mean_value_of_long_term_variability + histogram_variance + uterine_contractions, data = train_fetal_rebal)
l <- summary(logreg02)
l
lpred <- predict(logreg02, fetal_test_copy, type = 'class')
table(fetal_test_copy$fetal_health, lpred)
